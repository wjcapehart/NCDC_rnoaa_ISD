Days_from_1970_01_01 = as.numeric( as.Date(Date) )
index_days           = Days_from_1970_01_01      -
min(Days_from_1970_01_01) +
1
new_variable   = Days_from_1970_01_01
new_variable[] = NA
if ("TMAX" %in% available_datafields)  {
tmax             = new_variable
index_tmax       = as.numeric(tmax_full_field$date) - Days_from_1970_01_01[1] + 1
index_tmax       = index_tmax[which(index_tmax <= max(index_days)) ]
index_tmax       = index_tmax[which(index_tmax >= min(index_days)) ]
tmax[index_tmax] = tmax_full_field$tmax[index_tmax]
remove(tmax_full_field,
index_tmax)
}
if ("TMIN" %in% available_datafields)  {
tmin             = new_variable
index_tmin       = as.numeric(tmin_full_field$date) - Days_from_1970_01_01[1] + 1
index_tmin       = index_tmin[which(index_tmin <= max(index_days)) ]
index_tmin       = index_tmin[which(index_tmin >= min(index_days)) ]
tmin[index_tmin] = tmin_full_field$tmin[index_tmin]
remove(tmin_full_field,
index_tmin)
}
if ("TAVG" %in% available_datafields)  {
tavg             = new_variable
index_tavg       = as.numeric(tavg_full_field$date) - Days_from_1970_01_01[1] + 1
index_tavg       = index_tavg[which(index_tavg <= max(index_days)) ]
index_tavg       = index_tavg[which(index_tavg >= min(index_days)) ]
tavg[index_tavg] = tavg_full_field$tavg[index_tavg]
print(tavg)
remove(tavg_full_field,
index_tavg)
}
if ("PRCP" %in% available_datafields)  {
prcp             = new_variable
index_prcp       = as.numeric(prcp_full_field$date) - Days_from_1970_01_01[1] + 1
index_prcp       = index_prcp[which(index_prcp <= max(index_days)) ]
index_prcp       = index_prcp[which(index_prcp >= min(index_days)) ]
prcp[index_prcp] = prcp_full_field$prcp[index_prcp]
remove(prcp_full_field,
index_prcp)
}
if ("SNOW" %in% available_datafields)  {
snow             = new_variable
index_snow       = as.numeric(snow_full_field$date) - Days_from_1970_01_01[1] + 1
index_snow       = index_snow[which(index_snow <= max(index_days)) ]
index_snow       = index_snow[which(index_snow >= min(index_days)) ]
snow[index_snow] = snow_full_field$snow[index_snow]
remove(snow_full_field,
index_snow)
}
if ("SNWD" %in% available_datafields)  {
snwd             = new_variable
index_snwd       = as.numeric(snwd_full_field$date) - Days_from_1970_01_01[1] + 1
index_snwd       = index_snwd[which(index_snwd <= max(index_days)) ]
index_snwd       = index_snwd[which(index_snwd >= min(index_days)) ]
snwd[index_snwd] = snwd_full_field$snwd[index_snwd]
remove(snwd_full_field,
index_snwd)
}
if ("WESD" %in% available_datafields)  {
wesd             = new_variable
index_wesd       = as.numeric(wesd_full_field$date) - Days_from_1970_01_01[1] + 1
index_wesd       = index_wesd[which(index_wesd <= max(index_days)) ]
index_wesd       = index_wesd[which(index_wesd >= min(index_days)) ]
wesd[index_wesd] = wesd_full_field$wesd[index_wesd]
remove(wesd_full_field,
index_wesd)
}
if ("WESF" %in% available_datafields)  {
wesf             = new_variable
index_wesf       = as.numeric(wesf_full_field$date) - Days_from_1970_01_01[1] + 1
index_wesf       = index_wesf[which(index_wesf <= max(index_days)) ]
index_wesf       = index_wesf[which(index_wesf >= min(index_days)) ]
wesf[index_wesf] = wesf_full_field$wesf[index_wesf]
remove(wesf_full_field,
index_wesf)
}
remove(new_variable,
index_days)
library("rnoaa")
library("isdparser")
library("lubridate")
library("ncdf4")
library("dplyr")
library("openair")
library("rlist")
working_year = 1980
ncdc_ids = ncdc_stations(locationid = 'CITY:US460006',
datasetid  = 'GHCND',
limit      = 1000)
n_stations = ncdc_ids$meta$pageCount
ncdc_ids = ncdc_ids$data
ncdc_ids
total_number_of_stations = length(ncdc_ids$name)
ncdc_index = 47  #20
station_name_label     = ncdc_ids$name[ncdc_index]
station_latitude       = ncdc_ids$latitude[ncdc_index]
station_longitude      = ncdc_ids$longitude[ncdc_index]
station_altitude       = ncdc_ids$elevation[ncdc_index]
ncdc_id_code = ncdc_ids$id[ncdc_index]
ghcn_station_code = unlist(strsplit(x      = ncdc_id_code,
split  = ":"))
ncdc_start_yymmdd = ncdc_ids$mindate[ncdc_index]
ncdc_end_yymmdd   = ncdc_ids$maxdate[ncdc_index]
Date = seq(from = as.Date(ncdc_start_yymmdd),
to   = as.Date(ncdc_end_yymmdd),
by   = "days")
ncdc_data = ghcnd(stationid = ghcn_station_code[2])
available_datafields = unique(ncdc_data$element)
sorted_data = ghcnd_splitvars(ncdc_data)
filename_station_label = ncdc_ids$name[ncdc_index]
filename_station_label = gsub(" US",  "",  filename_station_label)
filename_station_label = gsub(  ",",  "",  filename_station_label)
filename_station_label = gsub(  " ", "_",  filename_station_label)
filename_ghcn_label = ncdc_ids$id[ncdc_index]
filename_ghcn_label = gsub(":", "-", filename_ghcn_label)
file_title_string = paste(filename_ghcn_label,
"__",
filename_station_label,
sep="")
remove(ncdc_data)
if ("TMAX" %in% available_datafields)  {
tmax_full_field          = sorted_data$tmax
ordered                = order(tmax_full_field$date)
tmax_full_field$tmax[] = tmax_full_field$tmax[ordered] / 10
tmax_full_field$date[] = tmax_full_field$date[ordered]
}
if ("TMIN" %in% available_datafields)  {
tmin_full_field          = sorted_data$tmin
ordered                = order(tmin_full_field$date)
tmin_full_field$tmin[] = tmin_full_field$tmin[ordered] / 10
tmin_full_field$date[] = tmin_full_field$date[ordered]
}
if ("TAVG" %in% available_datafields)  {
tavg_full_field          = sorted_data$tavg
ordered                = order(tavg_full_field$date)
tavg_full_field$tavg[] = tavg_full_field$tavg[ordered] / 10
tavg_full_field$date[] = tavg_full_field$date[ordered]
print(tavg_full_field)
}
if ("PRCP" %in% available_datafields)  {
prcp_full_field          = sorted_data$prcp
ordered                = order(prcp_full_field$date)
prcp_full_field$prcp[] = prcp_full_field$prcp[ordered] / 10
prcp_full_field$date[] = prcp_full_field$date[ordered]
}
if ("SNOW" %in% available_datafields)  {
snow_full_field          = sorted_data$snow
ordered                = order(snow_full_field$date)
snow_full_field$snow[] = snow_full_field$snow[ordered]
snow_full_field$date[] = snow_full_field$date[ordered]
}
if ("SNWD" %in% available_datafields)  {
snwd_full_field          = sorted_data$snwd
ordered                = order(snwd_full_field$date)
snwd_full_field$snwd[] = snwd_full_field$snwd[ordered]
snwd_full_field$date[] = snwd_full_field$date[ordered]
}
if ("WESD" %in% available_datafields)  {
wesd_full_field          = sorted_data$wesd
ordered                = order(wesd_full_field$date)
wesd_full_field$wesd[] = wesd_full_field$wesd[ordered] / 10
wesd_full_field$date[] = wesd_full_field$date[ordered]
}
if ("WESF" %in% available_datafields)  {
wesf_full_field          = sorted_data$wesf
ordered                = order(wesf_full_field$date)
wesf_full_field$wesf[] = wesf_full_field$wesf[ordered] / 10
wesf_full_field$date[] = wesf_full_field$date[ordered]
}
remove(sorted_data,
ordered)
Days_from_1970_01_01 = as.numeric( as.Date(Date) )
index_days           = Days_from_1970_01_01      -
min(Days_from_1970_01_01) +
1
new_variable   = Days_from_1970_01_01
new_variable[] = NA
if ("TMAX" %in% available_datafields)  {
tmax             = new_variable
index_tmax       = as.numeric(tmax_full_field$date) - Days_from_1970_01_01[1] + 1
index_tmax       = index_tmax[which(index_tmax <= max(index_days)) ]
index_tmax       = index_tmax[which(index_tmax >= min(index_days)) ]
tmax[index_tmax] = tmax_full_field$tmax[index_tmax]
remove(tmax_full_field,
index_tmax)
}
if ("TMIN" %in% available_datafields)  {
tmin             = new_variable
index_tmin       = as.numeric(tmin_full_field$date) - Days_from_1970_01_01[1] + 1
index_tmin       = index_tmin[which(index_tmin <= max(index_days)) ]
index_tmin       = index_tmin[which(index_tmin >= min(index_days)) ]
tmin[index_tmin] = tmin_full_field$tmin[index_tmin]
remove(tmin_full_field,
index_tmin)
}
if ("TAVG" %in% available_datafields)  {
tavg             = new_variable
index_tavg       = as.numeric(tavg_full_field$date) - Days_from_1970_01_01[1] + 1
index_tavg       = index_tavg[which(index_tavg <= max(index_days)) ]
index_tavg       = index_tavg[which(index_tavg >= min(index_days)) ]
tavg[index_tavg] = tavg_full_field$tavg[index_tavg]
print(index_tavg)
remove(tavg_full_field,
index_tavg)
}
if ("PRCP" %in% available_datafields)  {
prcp             = new_variable
index_prcp       = as.numeric(prcp_full_field$date) - Days_from_1970_01_01[1] + 1
index_prcp       = index_prcp[which(index_prcp <= max(index_days)) ]
index_prcp       = index_prcp[which(index_prcp >= min(index_days)) ]
prcp[index_prcp] = prcp_full_field$prcp[index_prcp]
remove(prcp_full_field,
index_prcp)
}
if ("SNOW" %in% available_datafields)  {
snow             = new_variable
index_snow       = as.numeric(snow_full_field$date) - Days_from_1970_01_01[1] + 1
index_snow       = index_snow[which(index_snow <= max(index_days)) ]
index_snow       = index_snow[which(index_snow >= min(index_days)) ]
snow[index_snow] = snow_full_field$snow[index_snow]
remove(snow_full_field,
index_snow)
}
if ("SNWD" %in% available_datafields)  {
snwd             = new_variable
index_snwd       = as.numeric(snwd_full_field$date) - Days_from_1970_01_01[1] + 1
index_snwd       = index_snwd[which(index_snwd <= max(index_days)) ]
index_snwd       = index_snwd[which(index_snwd >= min(index_days)) ]
snwd[index_snwd] = snwd_full_field$snwd[index_snwd]
remove(snwd_full_field,
index_snwd)
}
if ("WESD" %in% available_datafields)  {
wesd             = new_variable
index_wesd       = as.numeric(wesd_full_field$date) - Days_from_1970_01_01[1] + 1
index_wesd       = index_wesd[which(index_wesd <= max(index_days)) ]
index_wesd       = index_wesd[which(index_wesd >= min(index_days)) ]
wesd[index_wesd] = wesd_full_field$wesd[index_wesd]
remove(wesd_full_field,
index_wesd)
}
if ("WESF" %in% available_datafields)  {
wesf             = new_variable
index_wesf       = as.numeric(wesf_full_field$date) - Days_from_1970_01_01[1] + 1
index_wesf       = index_wesf[which(index_wesf <= max(index_days)) ]
index_wesf       = index_wesf[which(index_wesf >= min(index_days)) ]
wesf[index_wesf] = wesf_full_field$wesf[index_wesf]
remove(wesf_full_field,
index_wesf)
}
remove(new_variable,
index_days)
wesf_full_field$date
library("rnoaa")
library("isdparser")
library("lubridate")
library("ncdf4")
library("dplyr")
library("openair")
library("rlist")
working_year = 1980
ncdc_ids = ncdc_stations(locationid = 'CITY:US460006',
datasetid  = 'GHCND',
limit      = 1000)
n_stations = ncdc_ids$meta$pageCount
ncdc_ids = ncdc_ids$data
ncdc_ids
total_number_of_stations = length(ncdc_ids$name)
ncdc_index = 47  #20
station_name_label     = ncdc_ids$name[ncdc_index]
station_latitude       = ncdc_ids$latitude[ncdc_index]
station_longitude      = ncdc_ids$longitude[ncdc_index]
station_altitude       = ncdc_ids$elevation[ncdc_index]
ncdc_id_code = ncdc_ids$id[ncdc_index]
ghcn_station_code = unlist(strsplit(x      = ncdc_id_code,
split  = ":"))
ncdc_start_yymmdd = ncdc_ids$mindate[ncdc_index]
ncdc_end_yymmdd   = ncdc_ids$maxdate[ncdc_index]
Date = seq(from = as.Date(ncdc_start_yymmdd),
to   = as.Date(ncdc_end_yymmdd),
by   = "days")
ncdc_data = ghcnd(stationid = ghcn_station_code[2])
available_datafields = unique(ncdc_data$element)
sorted_data = ghcnd_splitvars(ncdc_data)
filename_station_label = ncdc_ids$name[ncdc_index]
filename_station_label = gsub(" US",  "",  filename_station_label)
filename_station_label = gsub(  ",",  "",  filename_station_label)
filename_station_label = gsub(  " ", "_",  filename_station_label)
filename_ghcn_label = ncdc_ids$id[ncdc_index]
filename_ghcn_label = gsub(":", "-", filename_ghcn_label)
file_title_string = paste(filename_ghcn_label,
"__",
filename_station_label,
sep="")
remove(ncdc_data)
if ("TMAX" %in% available_datafields)  {
tmax_full_field          = sorted_data$tmax
ordered                = order(tmax_full_field$date)
tmax_full_field$tmax[] = tmax_full_field$tmax[ordered] / 10
tmax_full_field$date[] = tmax_full_field$date[ordered]
}
if ("TMIN" %in% available_datafields)  {
tmin_full_field          = sorted_data$tmin
ordered                = order(tmin_full_field$date)
tmin_full_field$tmin[] = tmin_full_field$tmin[ordered] / 10
tmin_full_field$date[] = tmin_full_field$date[ordered]
}
if ("TAVG" %in% available_datafields)  {
tavg_full_field          = sorted_data$tavg
ordered                = order(tavg_full_field$date)
tavg_full_field$tavg[] = tavg_full_field$tavg[ordered] / 10
tavg_full_field$date[] = tavg_full_field$date[ordered]
print(tavg_full_field)
}
if ("PRCP" %in% available_datafields)  {
prcp_full_field          = sorted_data$prcp
ordered                = order(prcp_full_field$date)
prcp_full_field$prcp[] = prcp_full_field$prcp[ordered] / 10
prcp_full_field$date[] = prcp_full_field$date[ordered]
}
if ("SNOW" %in% available_datafields)  {
snow_full_field          = sorted_data$snow
ordered                = order(snow_full_field$date)
snow_full_field$snow[] = snow_full_field$snow[ordered]
snow_full_field$date[] = snow_full_field$date[ordered]
}
if ("SNWD" %in% available_datafields)  {
snwd_full_field          = sorted_data$snwd
ordered                = order(snwd_full_field$date)
snwd_full_field$snwd[] = snwd_full_field$snwd[ordered]
snwd_full_field$date[] = snwd_full_field$date[ordered]
}
if ("WESD" %in% available_datafields)  {
wesd_full_field          = sorted_data$wesd
ordered                = order(wesd_full_field$date)
wesd_full_field$wesd[] = wesd_full_field$wesd[ordered] / 10
wesd_full_field$date[] = wesd_full_field$date[ordered]
}
if ("WESF" %in% available_datafields)  {
wesf_full_field          = sorted_data$wesf
ordered                = order(wesf_full_field$date)
wesf_full_field$wesf[] = wesf_full_field$wesf[ordered] / 10
wesf_full_field$date[] = wesf_full_field$date[ordered]
}
remove(sorted_data,
ordered)
library("rnoaa")
library("isdparser")
library("lubridate")
library("ncdf4")
library("dplyr")
library("openair")
library("rlist")
working_year = 1980
ncdc_ids = ncdc_stations(locationid = 'CITY:US460006',
datasetid  = 'GHCND',
limit      = 1000)
n_stations = ncdc_ids$meta$pageCount
ncdc_ids = ncdc_ids$data
ncdc_ids
total_number_of_stations = length(ncdc_ids$name)
ncdc_index = 47  #20
station_name_label     = ncdc_ids$name[ncdc_index]
station_latitude       = ncdc_ids$latitude[ncdc_index]
station_longitude      = ncdc_ids$longitude[ncdc_index]
station_altitude       = ncdc_ids$elevation[ncdc_index]
ncdc_id_code = ncdc_ids$id[ncdc_index]
ghcn_station_code = unlist(strsplit(x      = ncdc_id_code,
split  = ":"))
ncdc_start_yymmdd = ncdc_ids$mindate[ncdc_index]
ncdc_end_yymmdd   = ncdc_ids$maxdate[ncdc_index]
Date = seq(from = as.Date(ncdc_start_yymmdd),
to   = as.Date(ncdc_end_yymmdd),
by   = "days")
ncdc_data = ghcnd(stationid = ghcn_station_code[2])
available_datafields = unique(ncdc_data$element)
sorted_data = ghcnd_splitvars(ncdc_data)
filename_station_label = ncdc_ids$name[ncdc_index]
filename_station_label = gsub(" US",  "",  filename_station_label)
filename_station_label = gsub(  ",",  "",  filename_station_label)
filename_station_label = gsub(  " ", "_",  filename_station_label)
filename_ghcn_label = ncdc_ids$id[ncdc_index]
filename_ghcn_label = gsub(":", "-", filename_ghcn_label)
file_title_string = paste(filename_ghcn_label,
"__",
filename_station_label,
sep="")
remove(ncdc_data)
if ("TMAX" %in% available_datafields)  {
tmax_full_field          = sorted_data$tmax
ordered                = order(tmax_full_field$date)
tmax_full_field$tmax[] = tmax_full_field$tmax[ordered] / 10
tmax_full_field$date[] = tmax_full_field$date[ordered]
}
if ("TMIN" %in% available_datafields)  {
tmin_full_field          = sorted_data$tmin
ordered                = order(tmin_full_field$date)
tmin_full_field$tmin[] = tmin_full_field$tmin[ordered] / 10
tmin_full_field$date[] = tmin_full_field$date[ordered]
}
if ("TAVG" %in% available_datafields)  {
tavg_full_field          = sorted_data$tavg
ordered                = order(tavg_full_field$date)
tavg_full_field$tavg[] = tavg_full_field$tavg[ordered] / 10
tavg_full_field$date[] = tavg_full_field$date[ordered]
print(tavg_full_field)
}
if ("PRCP" %in% available_datafields)  {
prcp_full_field          = sorted_data$prcp
ordered                = order(prcp_full_field$date)
prcp_full_field$prcp[] = prcp_full_field$prcp[ordered] / 10
prcp_full_field$date[] = prcp_full_field$date[ordered]
}
if ("SNOW" %in% available_datafields)  {
snow_full_field          = sorted_data$snow
ordered                = order(snow_full_field$date)
snow_full_field$snow[] = snow_full_field$snow[ordered]
snow_full_field$date[] = snow_full_field$date[ordered]
}
if ("SNWD" %in% available_datafields)  {
snwd_full_field          = sorted_data$snwd
ordered                = order(snwd_full_field$date)
snwd_full_field$snwd[] = snwd_full_field$snwd[ordered]
snwd_full_field$date[] = snwd_full_field$date[ordered]
}
if ("WESD" %in% available_datafields)  {
wesd_full_field          = sorted_data$wesd
ordered                = order(wesd_full_field$date)
wesd_full_field$wesd[] = wesd_full_field$wesd[ordered] / 10
wesd_full_field$date[] = wesd_full_field$date[ordered]
}
if ("WESF" %in% available_datafields)  {
wesf_full_field          = sorted_data$wesf
ordered                = order(wesf_full_field$date)
wesf_full_field$wesf[] = wesf_full_field$wesf[ordered] / 10
wesf_full_field$date[] = wesf_full_field$date[ordered]
}
remove(sorted_data,
ordered)
Days_from_1970_01_01 = as.numeric( as.Date(Date) )
index_days           = Days_from_1970_01_01      -
min(Days_from_1970_01_01) +
1
new_variable   = Days_from_1970_01_01
new_variable[] = NA
tmax             = new_variable
index_tmax       = as.numeric(tmax_full_field$date) - Days_from_1970_01_01[1] + 1
index_tmax       = index_tmax[which(index_tmax <= max(index_days)) ]
index_tmax       = index_tmax[which(index_tmax >= min(index_days)) ]
tmax[index_tmax] = tmax_full_field$tmax[index_tmax]
print(index_tmax)
print(tavg_full_field$date)
print(tmax_full_field$date)
print(tavg_full_field$date)
tavg             = new_variable
tavg_date        = as.numeric(tavg_full_field$date) - Days_from_1970_01_01[1] + 1
print(    index_tavg        = as.numeric(tavg_full_field$date) - Days_from_1970_01_01[1] + 1
)
index_tavg        = as.numeric(tavg_full_field$date) - Days_from_1970_01_01[1] + 1
print(index_tavg)
max(index_days)
min(index_days)
tavg_full_field$date
tavg_full_field$date
tavg             = new_variable
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(as.Date(Date)) ]
print(    tavg             = new_variable
)
tavg             = new_variable
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(as.Date(Date)) ]
print(tavg_date)
tavg_date        = tavg_date[ tavg_date >= min(as.Date(Date)) ]
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(Date) ]
tavg_date        = tavg_date[ tavg_date >=  min(Date) ]
print(tavg_date)
tavg             = new_variable
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(Date) ]
tavg_date        = tavg_date[ tavg_date >=  min(Date) ]
tavg[which(Date == tavg_date)] = tavg_full_field$tavg[which(Date == tavg_date)]
length(which(Date == tavg_date)
)
which(Date == tavg_date)
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(Date) ]
tavg_date        = tavg_date[ tavg_date >=  min(Date) ]
tavg             = new_variable
tavg_date        = tavg_full_field$date
length(tavg_date)
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(Date) ]
length(tavg_date)
tavg_date        = tavg_date[ tavg_date >=  min(Date) ]
length(tavg_date)
length*    tavg             = new_variable
'    tavg             = new_variable
'
tavg             = new_variable
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(Date) ]
print(tavg_date)
tavg             = new_variable
tavg_date        = tavg_full_field$date[ tavg_full_field$date <= max(Date) ]
tavg_date        = tavg_date[ tavg_date >=  min(Date) ]
length(tavg_date)
length(tavg)
which(Date == tavg_date)
which(as.numeric(Date) == as.numeric(tavg_date))
index_tavg        = as.numeric(tavg_full_field$date) - Days_from_1970_01_01[1] + 1
index_tavg       = index_tavg[which(index_tavg <= max(index_days)) ]
index_tavg       = index_tavg[which(index_tavg >= min(index_days)) ]
tavg[index_tavg]
tavg_full_field$tavg[index_tavg]
